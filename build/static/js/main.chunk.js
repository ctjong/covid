(this.webpackJsonpcovid19=this.webpackJsonpcovid19||[]).push([[0],{178:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(31),s=a.n(c);a(78),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var o,i=a(2),u=a.n(i),l=a(15),h=a(6),d=a(5),f=a(16),p=a(17),v=a(69),m=a(70),b=(a(80),"nytimes"),y="johnhopkins",w="countyCases",g="countyDeaths",k="countryCases",x="countryDeaths",T="countryRecovereds",D=(o={},Object(d.a)(o,w,{title:"Number of cases in the US by county (top 100)",buttonText:"US cases by county",srcLink:"https://www.nytimes.com/interactive/2020/us/coronavirus-us-cases.html",srcText:"New York Times",chartLabel:"number of cases by county",timeline:!0}),Object(d.a)(o,g,{title:"Number of deaths in the US by county (top 100)",buttonText:"US deaths by county",srcLink:"https://www.nytimes.com/interactive/2020/us/coronavirus-us-cases.html",srcText:"New York Times",chartLabel:"number of cases by county",timeline:!0}),Object(d.a)(o,k,{title:"Number of cases in the world by country",buttonText:"Cases by country",srcLink:"https://github.com/pomber/covid19",srcText:"John Hopkins",chartLabel:"number of cases by country",timeline:!0}),Object(d.a)(o,x,{title:"Number of deaths in the world by country",buttonText:"Deaths by country",srcLink:"https://github.com/pomber/covid19",srcText:"John Hopkins",chartLabel:"number of deaths by country",timeline:!0}),Object(d.a)(o,T,{title:"Number of recovered people in the world by country",buttonText:"Recovered people by country",srcLink:"https://github.com/pomber/covid19",srcText:"John Hopkins",chartLabel:"number of recovered people by country",timeline:!0}),o),j=[{dataSource:y,args:{targetTabNames:[k,x,T]}},{dataSource:b,args:{targetTabNames:[w,g]}}],E=function(){function e(){Object(f.a)(this,e)}return Object(p.a)(e,[{key:"retrieveData",value:function(e){var t=this;return new Promise(function(){var e=Object(h.a)(u.a.mark((function e(a){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:fetch("https://raw.githubusercontent.com/nytimes/covid-19-data/master/us-counties.csv").then((function(e){return e.text()})).then((function(e){return a(t._parseData(t._csvToJson(e)))}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},{key:"_csvToJson",value:function(e){var t=e.split("\n"),a=t.shift().split(","),n=[];return t.forEach((function(e){var t={},r=e.split(",");a.forEach((function(e,a){t[e]=r[a]})),n.push(t)})),n}},{key:"_parseData",value:function(e){var t,a=this,n="Last updated: ".concat(this._getDateString(new Date)),r=(t={},Object(d.a)(t,w,{updateTime:n,records:[]}),Object(d.a)(t,g,{updateTime:n,records:[]}),t),c={};return e.forEach((function(e){c[e.date]||(c[e.date]=[]),c[e.date].push(Object(l.a)({},e))})),Object.keys(c).forEach((function(e){a._parseRecordsByDate(r,c,e,w,(function(e){return e.cases})),a._parseRecordsByDate(r,c,e,g,(function(e){return e.deaths}))})),r}},{key:"_parseRecordsByDate",value:function(e,t,a,n,r){var c=t[a].map((function(e){return{name:"".concat(e.state,"/").concat(e.county),value:parseInt(r(e))}})).filter((function(e){return e.value||0===e.value}));c.length>0&&e[n].records.push({date:a,entries:c})}},{key:"_getDateString",value:function(e){return"".concat(e.getFullYear(),"-").concat(e.getMonth()+1,"-").concat(e.getDate())}}]),e}(),O=a(62),S=a(64),A=a.n(S),N=a(189),R=a(191),C=function(){function e(){Object(f.a)(this,e)}return Object(p.a)(e,[{key:"retrieveData",value:function(e){var t=this;return new Promise(function(){var e=Object(h.a)(u.a.mark((function e(a){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:fetch("https://pomber.github.io/covid19/timeseries.json").then((function(e){return e.json()})).then((function(e){return a(t._parseData(e))}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},{key:"_parseData",value:function(e){var t,a=this,n="Last updated: ".concat(this._getDateString(new Date)),r=(t={},Object(d.a)(t,k,{updateTime:n,records:[]}),Object(d.a)(t,x,{updateTime:n,records:[]}),Object(d.a)(t,T,{updateTime:n,records:[]}),t),c={};return Object.keys(e).forEach((function(t){e[t].forEach((function(e){c[e.date]||(c[e.date]=[]),c[e.date].push(Object(l.a)({country:t},e))}))})),Object.keys(c).forEach((function(e){a._parseRecordsByDate(r,c,e,k,(function(e){return e.confirmed})),a._parseRecordsByDate(r,c,e,x,(function(e){return e.deaths})),a._parseRecordsByDate(r,c,e,T,(function(e){return e.recovered}))})),r}},{key:"_parseRecordsByDate",value:function(e,t,a,n,r){var c=t[a].map((function(e){return{name:e.country,value:r(e)}})).filter((function(e){return e.value||0===e.value}));c.length>0&&e[n].records.push({date:a,entries:c})}},{key:"_getDateString",value:function(e){return"".concat(e.getFullYear(),"-").concat(e.getMonth()+1,"-").concat(e.getDate())}}]),e}(),_=a(12),L=function(e){Object(m.a)(a,e);var t=Object(v.a)(a);function a(e){var n,c;return Object(f.a)(this,a),(c=t.call(this,e)).searchInputRef=void 0,c.colors={},c.parsers=(n={},Object(d.a)(n,b,new E),Object(d.a)(n,y,new C),n),c.loadAllData(),c.searchInputRef=r.a.createRef(),_.Chart.defaults.global.defaultFontSize=14,c.state={allData:null,allCharts:{},activeTabName:c.getTabNameToSetAsActive(),activeRecordIndex:-1,searchKeyword:null},window.onpopstate=function(){c.setActiveTab(c.getTabNameToSetAsActive(),!1)},c}return Object(p.a)(a,[{key:"loadAllData",value:function(){var e=this,t=0,a={};new Promise((function(n){j.forEach((function(r){t++,e.parsers[r.dataSource].retrieveData(r.args).then(function(){var e=Object(h.a)(u.a.mark((function e(r){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=Object(l.a)({},a,{},r),--t<=0&&n();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}))})).then(Object(h.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.setStateAsync({allData:a});case 2:return t.next=4,e.updateActiveTabData();case 4:case"end":return t.stop()}}),t)}))))}},{key:"updateActiveTabData",value:function(){var e=Object(h.a)(u.a.mark((function e(){var t,a,n,r,c,s,o,i,h,d=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Object(l.a)({},this.state.allCharts),a=this.state.activeTabName,console.log(this.state.allData),n=this.state.allData[a],!(r=D[a]).timeline){e.next=14;break}if(!((s=this.state.activeRecordIndex)<0||s>=n.records.length)){e.next=11;break}return e.next=10,this.setStateAsync({activeRecordIndex:n.records.length-1});case 10:s=this.state.activeRecordIndex;case 11:c=n.records[s],e.next=15;break;case 14:c=n.records[n.records.length-1];case 15:return(o=this.state.searchKeyword?c.entries.filter((function(e){return e.name.toLowerCase().indexOf(d.state.searchKeyword)>=0})):c.entries).sort((function(e,t){return t.value-e.value})),i=o.reduce((function(e,t){return e+t.value}),0),(h=o.slice(0,100)).forEach((function(e){d.colors[e.name]||(d.colors[e.name]=d.getRandomColor())})),t[a]={total:i,labels:h.map((function(e){return e.name})),datasets:[{label:r.chartLabel,data:h.map((function(e){return e.value})),backgroundColor:h.map((function(e){return"rgba(".concat(d.colors[e.name],", 0.2)")})),borderColor:h.map((function(e){return"rgba(".concat(d.colors[e.name],", 1)")})),borderWidth:1}]},e.next=23,this.setStateAsync({allCharts:t});case 23:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setActiveTab",value:function(){var e=Object(h.a)(u.a.mark((function e(t,a){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.searchInputRef.current.value="",e.next=3,this.setStateAsync({searchKeyword:"",activeRecordIndex:-1,activeTabName:t});case 3:return e.next=5,this.updateActiveTabData();case 5:a&&window.history.pushState(null,window.document.title,"?".concat("chart","=").concat(t));case 6:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"applySearch",value:function(){var e=Object(h.a)(u.a.mark((function e(){var t,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.searchInputRef.current,this.state.allData){e.next=4;break}return t.value="",e.abrupt("return");case 4:return a=t.value.trim().toLowerCase(),e.next=7,this.setStateAsync({searchKeyword:a});case 7:return e.next=9,this.updateActiveTabData();case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"clearSearch",value:function(){var e=Object(h.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.searchInputRef.current.value="",e.next=4,this.setStateAsync({searchKeyword:""});case 4:return e.next=6,this.updateActiveTabData();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleDateChange",value:function(){var e=Object(h.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.setStateAsync({activeRecordIndex:t});case 2:return e.next=4,this.updateActiveTabData();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleSearchKeyPress",value:function(){var e=Object(h.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Enter"!==t.key){e.next=3;break}return e.next=3,this.applySearch();case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getQueryParam",value:function(e){var t=window.location.href,a=new RegExp("[?&]"+e+"=([^&#]*)","i").exec(t);return a?a[1]:null}},{key:"setStateAsync",value:function(e){var t=this;return new Promise((function(a){return t.setState(e,a)}))}},{key:"getTabNameToSetAsActive",value:function(){return this.getQueryParam("chart")||Object.keys(D)[0]}},{key:"getRandomColor",value:function(){var e=Math.floor(Math.random()*Math.floor(255)),t=Math.floor(Math.random()*Math.floor(255)),a=Math.floor(Math.random()*Math.floor(255));return"".concat(e,",").concat(t,",").concat(a)}},{key:"render",value:function(){var e=this;if(!this.state.activeTabName||!this.state.allData||!this.state.allCharts[this.state.activeTabName])return r.a.createElement("div",{className:"loading"},r.a.createElement(N.a,null),r.a.createElement("div",null,"Please wait"));var t=this.state.activeTabName,a=D[t],n=this.state.allCharts[t],c=this.state.allData[t],s=this.state.activeRecordIndex,o=this.state.allCharts[t],i=30*o.labels.length+50;return r.a.createElement("div",{className:"app"},r.a.createElement("div",{className:"header"},r.a.createElement("div",{className:"title-container"},r.a.createElement("h2",null,a.title),r.a.createElement("div",null,"Source: ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:a.srcLink},a.srcText)),r.a.createElement("div",null,c.updateTime),r.a.createElement("div",null,"Total: ",o.total),r.a.createElement("div",{className:"search"},r.a.createElement("input",{type:"text",id:"search-text",ref:this.searchInputRef,onKeyPress:function(t){return e.handleSearchKeyPress(t)}}),r.a.createElement("button",{type:"button",onClick:function(){return e.applySearch()}},"Search"),r.a.createElement("button",{type:"button",onClick:function(){return e.clearSearch()}},"Clear"))),r.a.createElement("div",{className:"chart-links"},r.a.createElement("div",null,r.a.createElement("label",null,"Available charts:")),Object.keys(D).map((function(a){var n=D[a];return a===t?r.a.createElement("div",null,n.buttonText):r.a.createElement("div",null,r.a.createElement("a",{onClick:function(){return e.setActiveTab(a,!0)}},n.buttonText))})))),r.a.createElement("div",{className:"chart-controls"},!a.timeline||s<0||s>=c.records.length?null:r.a.createElement("div",{className:"slider-container"},r.a.createElement(R.a,{className:"date-slider",defaultValue:c.records.length-1,valueLabelFormat:function(e){return c.records[e].date},valueLabelDisplay:"off",step:1,min:c.records.length-31,max:c.records.length-1,onChange:function(t,a){return e.handleDateChange(a)}}),r.a.createElement("div",null,"Date: ",c.records[s].date)),n?r.a.createElement("div",{className:"chart-container",style:{height:i}},r.a.createElement(O.a,{data:o,options:{scales:{yAxes:[{ticks:{beginAtZero:!0}}]},plugins:{datalabels:{anchor:"end",align:"end"}},legend:{display:!1},maintainAspectRatio:!1},plugins:[A.a]})):null),r.a.createElement("div",{className:"footer"},r.a.createElement("div",null,"\xa9\xa0",(new Date).getFullYear(),"\xa0",r.a.createElement("a",{href:"http://www.ctjong.com",target:"_blank"},"Christopher Tjong"),". All Rights Reserved.")))}}]),a}(r.a.Component);s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(L,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},73:function(e,t,a){e.exports=a(178)},78:function(e,t,a){},80:function(e,t,a){}},[[73,1,2]]]);
//# sourceMappingURL=main.chunk.js.map