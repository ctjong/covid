{"version":3,"sources":["ServiceWorker.ts","Constants.ts","parsers/NewYorkTimesParser.ts","parsers/JohnHopkinsParser.ts","App.tsx","Index.tsx"],"names":["Boolean","window","location","hostname","match","DATA_SOURCE","TAB_NAMES","TAB_CONFIG","title","buttonText","srcLink","srcText","chartLabel","color","timeline","DATA_RETRIEVAL_CONFIG","dataSource","args","tableClass","targetTabNames","dataParsers","cells","name","innerText","value","parseInt","replace","NYTimesParser","data","forEach","tabName","updateTime","document","querySelector","innerHTML","records","date","entries","Promise","resolve","_loadSourceTable","then","_parseSourceTable","timer","setInterval","button","clearInterval","click","rows","querySelectorAll","length","row","entry","push","JohnHopkinsParser","a","fetch","json","_parseData","srcData","this","_getDateString","Date","recordsByDate","Object","keys","country","countryRecord","_parseRecordsByDate","fieldName","map","srcRecord","filter","getFullYear","getMonth","getDate","App","props","searchInputRef","parsers","loadAllData","React","createRef","state","allData","allCharts","activeTabName","activeRecordIndex","searchKeyword","loadCount","config","retrieveData","setState","updateTab","tabConfig","record","filteredEntries","d","toLowerCase","indexOf","sort","b","total","reduce","sum","next","getElementById","chartEntries","slice","labels","e","datasets","label","backgroundColor","borderColor","borderWidth","current","textInput","trim","innerWidth","index","key","applySearch","activeTab","chart","tabData","recordIndex","className","FormControl","InputLabel","id","Select","labelId","onChange","setActiveTab","target","MenuItem","style","margin","type","ref","onKeyPress","handleSearchKeyPress","onClick","clearSearch","href","Slider","defaultValue","valueLabelFormat","valueLabelDisplay","step","min","max","width","ev","handleDateChange","options","scales","yAxes","ticks","beginAtZero","plugins","datalabels","anchor","align","ChartDataLabels","height","getChartHeight","Component","ReactDOM","render","StrictMode","navigator","serviceWorker","ready","registration","unregister","catch","error","console","message"],"mappings":"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","file":"static/js/main.chunk.js","sourcesContent":["// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import {\n  NameValueCollection\n} from \"./Types\";\n\nexport const DATA_SOURCE = {\n  NYTIMES: \"nytimes\",\n  JOHNHOPKINS: \"johnhopkins\",\n}\n\nexport const TAB_NAMES = {\n  stateCases: \"stateCases\",\n  stateDeaths: \"stateDeaths\",\n  countyCases: \"countyCases\",\n  countryCases: \"countryCases\",\n  countryDeaths: \"countryDeaths\",\n  countryRecovereds: \"countryRecovereds\",\n}\n\nexport const TAB_CONFIG:NameValueCollection = {\n  [TAB_NAMES.stateCases]: {\n    title: \"Number of cases in the US by state\",\n    buttonText: \"Number of cases in the US by state\",\n    srcLink: \"https://www.nytimes.com/interactive/2020/us/coronavirus-us-cases.html\",\n    srcText: \"New York Times\",\n    chartLabel: \"number of cases by state\",\n    color: \"54, 162, 235\",\n    timeline: false,\n  },\n  [TAB_NAMES.stateDeaths]: {\n    title: \"Number of deaths in the US by state\",\n    buttonText: \"Number of deaths in the US by state\",\n    srcLink: \"https://www.nytimes.com/interactive/2020/us/coronavirus-us-cases.html\",\n    srcText: \"New York Times\",\n    chartLabel: \"number of deaths by state\",\n    color: \"255, 206, 86\",\n    timeline: false,\n  },\n  [TAB_NAMES.countyCases]: {\n    title: \"Number of cases in the US by county (only showing the top 100)\",\n    buttonText: \"Number of cases in the US by county\",\n    srcLink: \"https://www.nytimes.com/interactive/2020/us/coronavirus-us-cases.html\",\n    srcText: \"New York Times\",\n    chartLabel: \"number of cases by county\",\n    color: \"255, 99, 132\",\n    timeline: false,\n  },\n  [TAB_NAMES.countryCases]: {\n    title: \"Number of cases in the world by country\",\n    buttonText: \"Number of cases in the world by country\",\n    srcLink: \"https://gisanddata.maps.arcgis.com/apps/opsdashboard/index.html#/bda7594740fd40299423467b48e9ecf6\",\n    srcText: \"John Hopkins\",\n    chartLabel: \"number of cases by country\",\n    color: \"75, 192, 192\",\n    timeline: true,\n  },\n  [TAB_NAMES.countryDeaths]: {\n    title: \"Number of deaths in the world by country\",\n    buttonText: \"Number of deaths in the world by country\",\n    srcLink: \"https://gisanddata.maps.arcgis.com/apps/opsdashboard/index.html#/bda7594740fd40299423467b48e9ecf6\",\n    srcText: \"John Hopkins\",\n    chartLabel: \"number of deaths by country\",\n    color: \"153, 102, 255\",\n    timeline: true,\n  },\n  [TAB_NAMES.countryRecovereds]: {\n    title: \"Number of recovered people in the world by country\",\n    buttonText: \"Number of recovered people in the world by country\",\n    srcLink: \"https://gisanddata.maps.arcgis.com/apps/opsdashboard/index.html#/bda7594740fd40299423467b48e9ecf6\",\n    srcText: \"John Hopkins\",\n    chartLabel: \"number of recovered people by country\",\n    color: \"255, 159, 64\",\n    timeline: true,\n  },\n}\n\nexport const DATA_RETRIEVAL_CONFIG = [\n  {\n    dataSource: DATA_SOURCE.NYTIMES,\n    args: {\n      tableClass: \"svelte-1k3kd4i\",\n      targetTabNames: [\n        TAB_NAMES.stateCases,\n        TAB_NAMES.stateDeaths,\n      ],\n    }\n  },\n  {\n    dataSource: DATA_SOURCE.NYTIMES,\n    args: {\n      tableClass: \"svelte-ffcf53\",\n      targetTabNames: [\n        TAB_NAMES.countyCases,\n      ],\n    }\n  },\n  {\n    dataSource: DATA_SOURCE.JOHNHOPKINS,\n    args: {\n      targetTabNames: [\n        TAB_NAMES.countryCases,\n        TAB_NAMES.countryDeaths,\n        TAB_NAMES.countryRecovereds,\n      ],\n    }\n  },\n];","import { CovidData, NameValueCollection } from \"../Types\";\nimport IParser from \"./IParser\";\nimport { TAB_NAMES } from \"../Constants\";\n\nconst dataParsers = {\n  [TAB_NAMES.stateCases]: (cells: NodeListOf<HTMLTableDataCellElement>) => ({\n    name: cells[0].innerText,\n    value: parseInt(cells[1].innerText.replace(/,/, '')),\n  }),\n  [TAB_NAMES.stateDeaths]: (cells: NodeListOf<HTMLTableDataCellElement>) => ({\n    name: cells[0].innerText,\n    value: parseInt(cells[2].innerText.replace(/,/, '')),\n  }),\n  [TAB_NAMES.countyCases]: (cells: NodeListOf<HTMLTableDataCellElement>) => ({\n    name: cells[0].innerText + \"/\" + cells[1].innerText,\n    value: parseInt(cells[2].innerText.replace(/,/, ''))\n  }),\n}\n\nexport default class NYTimesParser implements IParser{\n  retrieveData(args: NameValueCollection): Promise<CovidData> {\n    const data: CovidData = {};\n    args.targetTabNames.forEach((tabName:string) => {\n      data[tabName] = { \n        updateTime: document.querySelector(\".css-wcxsge\").innerHTML.replace(\"<!-- -->\", \"\"),\n        records: [{ date: \"default\", entries: [] }]\n      };\n    });\n    return new Promise(resolve => {\n      this._loadSourceTable(args.tableClass).then(() => {\n        this._parseSourceTable(data, args.tableClass, args.targetTabNames).then(() => {\n          resolve(data);\n        });\n      });\n    })\n  }\n\n  _loadSourceTable(tableClass: string) {\n    return new Promise((resolve) => {\n      const timer = setInterval(() => { \n        let button = document.querySelector(`button.${tableClass}`) as HTMLButtonElement;\n        if (button) {\n          clearInterval(timer);\n          button.click();\n          resolve();\n        }\n      }, 1000);\n    });\n  }\n  \n  _parseSourceTable(data: CovidData, tableClass: string, targetTabNames: string[]) {\n    return new Promise((resolve) => {\n      const timer = setInterval(() => { \n        const rows = document.querySelectorAll(`tbody tr.${tableClass}`);\n        if (rows.length > 10) {\n          clearInterval(timer);\n          rows.forEach((row) => {\n            targetTabNames.forEach(tabName => {\n              const entry = dataParsers[tabName](row.querySelectorAll(\"td\"));\n              data[tabName].records[0].entries.push(entry);\n            });\n          });\n          resolve();\n        }\n      }, 1000);\n    });\n  }\n}","import { CovidData, NameValueCollection, CovidRecord, CovidEntry } from \"../Types\";\nimport IParser from \"./IParser\";\nimport { TAB_NAMES } from \"../Constants\";\n\nconst sourceUrl = \"https://pomber.github.io/covid19/timeseries.json\";\n\nexport default class JohnHopkinsParser implements IParser {\n  retrieveData(args: NameValueCollection): Promise<CovidData> {\n    return new Promise(async resolve => {\n      fetch(sourceUrl)\n        .then(data => data.json())\n        .then(data => resolve(this._parseData(data)));\n    });\n  }\n\n  _parseData(srcData: any) {\n    const updateTime = `Last updated: ${this._getDateString(new Date())}`;\n    const data: CovidData = {\n      [TAB_NAMES.countryCases]: { updateTime, records: [] },\n      [TAB_NAMES.countryDeaths]: { updateTime, records: [] },\n      [TAB_NAMES.countryRecovereds]: { updateTime, records: [] },\n    };\n\n    const recordsByDate:NameValueCollection = {};\n    Object.keys(srcData).forEach(country => {\n      const countryData = srcData[country];\n      countryData.forEach((countryRecord: any) => {\n        if (!recordsByDate[countryRecord.date]) {\n          recordsByDate[countryRecord.date] = [];\n        }\n        recordsByDate[countryRecord.date].push({ ...countryRecord, country });\n      });\n    });\n\n    Object.keys(recordsByDate).forEach(date => {\n      this._parseRecordsByDate(data, recordsByDate, date, TAB_NAMES.countryCases, \"confirmed\");\n      this._parseRecordsByDate(data, recordsByDate, date, TAB_NAMES.countryDeaths, \"deaths\");\n      this._parseRecordsByDate(data, recordsByDate, date, TAB_NAMES.countryRecovereds, \"recovered\");\n    });\n\n    return data;\n  }\n\n  _parseRecordsByDate(data:CovidData, recordsByDate:NameValueCollection, date:string, tabName:string, fieldName:string) {\n    const entries:CovidEntry[] = recordsByDate[date].map((srcRecord:any) => ({\n      name: srcRecord.country,\n      value: srcRecord[fieldName]\n    })).filter((entry:CovidEntry) => entry.value || entry.value === 0);\n    if (entries.length > 0) {\n      data[tabName].records.push({ date, entries });\n    }\n  }\n\n  _getDateString(date: Date) {\n    return `${date.getFullYear()}-${date.getMonth() + 1}-${date.getDate()}`;\n  }\n}","import React from 'react';\nimport './App.css';\nimport {\n  TAB_CONFIG,\n  DATA_SOURCE,\n  DATA_RETRIEVAL_CONFIG,\n} from './Constants';\nimport { CovidData, NameValueCollection } from './Types';\nimport NYTimesParser from './parsers/NewYorkTimesParser';\nimport { HorizontalBar } from 'react-chartjs-2';\nimport IParser from './parsers/IParser';\nimport ChartDataLabels from 'chartjs-plugin-datalabels';\nimport { FormControl, InputLabel, Select, MenuItem, Slider, Typography } from '@material-ui/core';\nimport JohnHopkinsParser from './parsers/JohnHopkinsParser';\n\ntype StateType = {\n  allData: CovidData,\n  allCharts: NameValueCollection,\n  activeTabName: string,\n  activeRecordIndex: number,\n  searchKeyword: string,\n}\n\nexport default class App extends React.Component<{},StateType>{\n  searchInputRef:React.RefObject<any>;\n  parsers: {[dataSource:string]: IParser} = { \n    [DATA_SOURCE.NYTIMES]: new NYTimesParser(),\n    [DATA_SOURCE.JOHNHOPKINS]: new JohnHopkinsParser(),\n  };\n\n  constructor(props: {}) {\n    super(props);\n    this.loadAllData();\n    this.searchInputRef = React.createRef();\n    this.state = { \n      allData: null, \n      allCharts: {},\n      activeTabName: Object.keys(TAB_CONFIG)[0],\n      activeRecordIndex: -1,\n      searchKeyword: null,\n    };\n  }\n\n  loadAllData() {\n    let loadCount = 0;\n    let allData: CovidData = {};\n    new Promise(resolve => {\n      DATA_RETRIEVAL_CONFIG.forEach(config => {\n        loadCount++;\n        this.parsers[config.dataSource].retrieveData(config.args).then(async (data) => {\n          allData = { ...allData, ...data };\n          loadCount--;\n          if (loadCount <= 0) {\n            resolve();\n          }\n        });\n      });\n    }).then(async () => {\n      await this.setState({ allData })\n      await this.updateTab(this.state.activeTabName);\n    });\n  }\n\n  async updateTab(tabName: string) {\n    const allCharts = { ...this.state.allCharts };\n    const data = this.state.allData[tabName];\n    const tabConfig = TAB_CONFIG[tabName];\n\n    let record;\n    if (tabConfig.timeline) {\n      let { activeRecordIndex } = this.state;\n      if (activeRecordIndex < 0 || activeRecordIndex >= data.records.length) {\n        await this.setState({ activeRecordIndex: data.records.length - 1 });\n        activeRecordIndex = this.state.activeRecordIndex;\n      }\n      record = data.records[activeRecordIndex];\n    } else {\n      record = data.records[data.records.length - 1];\n    }\n    \n    const filteredEntries = !this.state.searchKeyword ? record.entries :\n      record.entries.filter(d => d.name.toLowerCase().indexOf(this.state.searchKeyword) >= 0);\n      filteredEntries.sort((a, b) => b.value - a.value);\n    const total = filteredEntries.reduce((sum, next) => sum + next.value, 0);\n    document.getElementById(`${tabName}-total`).innerHTML = `Total: ${total}`;\n  \n    const chartEntries = filteredEntries.slice(0, 100);\n    allCharts[tabName] = {\n      labels: chartEntries.map((e) => { return e.name } ),\n      datasets: [{\n          label: tabConfig.chartLabel,\n          data: chartEntries.map((e) => { return e.value } ),\n          backgroundColor: `rgba(${tabConfig.color}, 0.2)`,\n          borderColor: `rgba(${tabConfig.color}, 1)`,\n          borderWidth: 1,\n      }]\n    };\n\n    await this.setState({ allCharts });\n  }\n  \n  async setActiveTab(tabName: string) {\n    this.searchInputRef.current.value = \"\";\n    await this.setState({\n      searchKeyword: \"\",\n      activeRecordIndex: -1,\n      activeTabName: tabName\n    });\n    await this.updateTab(this.state.activeTabName);\n  }\n  \n  async applySearch() {\n    const textInput = this.searchInputRef.current;\n    if (!this.state.allData) {\n      textInput.value = \"\";\n      return;\n    }\n    const searchKeyword = textInput.value.trim().toLowerCase();\n    await this.setState({ searchKeyword });\n    await this.updateTab(this.state.activeTabName);\n  }\n  \n  async clearSearch() {\n    const textInput = this.searchInputRef.current;\n    textInput.value = \"\";\n    await this.setState({ searchKeyword: \"\" });\n    await this.updateTab(this.state.activeTabName);\n  }\n\n  getChartHeight() {\n    if (window.innerWidth < 500) {\n      return window.innerWidth * 3;\n    } else if (window.innerWidth < 750) {\n        return window.innerWidth * 2;\n    } else if (window.innerWidth < 1000) {\n      return window.innerWidth;\n    } else if (window.innerWidth < 1250) {\n      return window.innerWidth * 0.5;\n    } else {\n      return window.innerWidth * 0.25;\n    }\n  }\n\n  async handleDateChange(index: number) {\n    await this.setState({ activeRecordIndex: index });\n    await this.updateTab(this.state.activeTabName);\n  }\n\n  async handleSearchKeyPress(e:any) {\n    if(e.key === 'Enter') { \n      await this.applySearch();\n    }\n  }\n\n  render() {\n    if (!this.state.activeTabName || !this.state.allData) {\n      return null;\n    }\n    const tabName = this.state.activeTabName;\n    const activeTab = TAB_CONFIG[tabName];\n    const chart = this.state.allCharts[tabName];\n    const tabData = this.state.allData[tabName];\n    const recordIndex = this.state.activeRecordIndex;\n\n    return (\n      <div className=\"app\">\n        <FormControl>\n          <InputLabel id=\"chart-select-label\">Select chart</InputLabel>\n          <Select\n            labelId=\"chart-select-label\"\n            id=\"chart-select\"\n            value={this.state.activeTabName}\n            onChange={(e:any) => this.setActiveTab(e.target.value)}>\n              {\n                Object.keys(TAB_CONFIG).map(tabName => {\n                  const config = TAB_CONFIG[tabName];\n                  return <MenuItem value={tabName}>{config.buttonText}</MenuItem>\n                })\n              }\n          </Select>\n        </FormControl>\n\n        <div id=\"search\" style={{margin:\"20px 0 50px\"}}>\n          <input type=\"text\" id=\"search-text\" ref={this.searchInputRef} onKeyPress={e => this.handleSearchKeyPress(e)}/>\n          <button type=\"button\" onClick={() => this.applySearch()}>Search</button>\n          <button type=\"button\" onClick={() => this.clearSearch()}>Clear</button>\n        </div>\n\n        <div>\n          <h2>{activeTab.title}</h2>\n          <div>Source: <a target=\"_blank\" href={activeTab.srcLink}>{activeTab.srcText}</a></div>\n          <div>{tabData.updateTime}</div>\n          <div id={`${tabName}-total`}></div>\n\n          {!activeTab.timeline || recordIndex < 0 || recordIndex >= tabData.records.length ? null :\n            <div style={{margin: \"20px 0\"}}>\n              <Slider\n                className=\"date-slider\"\n                defaultValue={tabData.records.length - 1}\n                valueLabelFormat={value => tabData.records[value].date}\n                valueLabelDisplay=\"off\"\n                step={1}\n                min={tabData.records.length - 31}\n                max={tabData.records.length - 1}\n                style={{ width:500 }}\n                onChange={(ev: any, index: number) => this.handleDateChange(index) }\n              />\n              <div>Date: {tabData.records[recordIndex].date}</div>\n            </div>\n          }\n\n          {!chart ? null : \n            <HorizontalBar\n              data={this.state.allCharts[tabName]}\n              options={{\n                scales: { yAxes: [{ ticks: { beginAtZero: true } }] },\n                plugins: { datalabels: { anchor: 'end', align: 'end' } },\n              }}\n              plugins={[ChartDataLabels]}\n              height={this.getChartHeight()}\n            />\n          }\n        </div>\n      </div>\n    );\n  }\n}","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport * as serviceWorker from './ServiceWorker';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}